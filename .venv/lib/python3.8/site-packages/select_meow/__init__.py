from nonebot.adapters.onebot.v11 import  Message
from .config import *

from nonebot.params import CommandArg
import random
import nonebot
from typing import List
from nonebot import on_regex
import re
from nonebot.adapters.onebot.v11 import GROUP, Message,GroupMessageEvent
from nonebot.adapters import Bot
__plugin_name__ = '喵呜'

global_config = nonebot.get_driver().config
waifu_config: Config = Config.parse_obj(global_config.dict())

plugin_aliases: List[str] = waifu_config.today_waifu_aliases
# 正则匹配插件名与别名的字符串
PatternStr = '|'.join([__plugin_name__, ] + plugin_aliases)

# 响应器主体
select_mewo = on_regex(
    pattern=rf'^\s*({PatternStr})\s*$',
    flags=re.S,
    priority=7,
    block=True,
)

@select_mewo.handle()
async def _(bot: Bot, event: GroupMessageEvent):
    meow = ["喵","啊"]
    wu = "呜"
    characters = ["","!","~","!!","~~"]
    message = random.choice(meow) + random.choice(wu) + random.choice(characters)
    await select_mewo.finish(message)



